import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from"react/jsx-runtime";import{createElement as _createElement}from"react";import{addPropertyControls,ControlType,RenderTarget,// @ts-ignore ResolveLinks,// @ts-ignore useQueryData,// @ts-ignore PathVariablesContext,MotionConfigContext}from"framer";import{cloneElement,useEffect,useRef,useMemo,memo,useContext,useId}from"react";import{motion,LayoutGroup}from"framer-motion";import{Message,sortingControls,FAVOURITES_FILTER_ID,DELIMITER,FieldType,FilterFieldType,FilterTextCondition,DEFAULT_SORTING_ID}from"https://framerusercontent.com/modules/FZjYlw33eNo8pxLbSFLX/NS2M1g7qVI7y5CFDNb6m/SuperfieldsShared.js";import{getCollectionData,addFieldsToSelect}from"https://framerusercontent.com/modules/PNm0aYRdp2Urx1MCseUn/ELGxjV92WFMoGKTv2Ojs/CMSLibrary.js";import
Masonry from"https://framerusercontent.com/modules/JfW6EfEeJnrqM1YQCYmc/GJijJu4WrREqn6Sg1VOH/Masonry.js";import useSuperfieldsStore from"https://framerusercontent.com/modules/OoGHZMzWDzm2mNN7bmeR/UmOIjvpgKrLZznysVdbK/Store.js";import useFavouriteStore
from"https://framerusercontent.com/modules/c1jaZMVo1HBulMCJfZHW/nDkfDJo0USWraGjwBvUd/FavouriteStore.js";const fieldTypeNames={[FieldType.String]:"Text",[FieldType.Number]:"Number",[FieldType.Date]:"Date",[FieldType.Boolean]:"Toggle",[FieldType.Enum]:"Option"};var
Order;(function(Order){Order["Ascending"]="ascending";Order["Descending"]="descending";})(Order||(Order={}));var PaginationType;(function(PaginationType){PaginationType["PrevNextButtons"]="prevNextButtons";PaginationType["LoadMoreButton"]="loadMoreButton";PaginationType["FramerPagination"]="framerPagination";})(PaginationType||(PaginationType={}));export
var LayoutType;(function(LayoutType){LayoutType["Stack"]="stack";LayoutType["Grid"]="grid";LayoutType["Masonry"]="masonry";})(LayoutType||(LayoutType={}));export var SearchFieldType;(function(SearchFieldType){SearchFieldType["Default"]="default";SearchFieldType["Reference"]="reference";})(SearchFieldType||(SearchFieldType={}));/**
* @framerSupportedLayoutWidth any-prefer-fixed * @framerSupportedLayoutHeight any * @framerIntrinsicWidth 600 * @framerDisableUnlink */export default function Superfields(props){const{superfieldsId,layout,componentConfig,cmsCollectionName,favouritesOnly,searchFields,sortingField,urlParameters,slugFieldName,scrollUp,transition,customOverrideFilter=null,customOverrideSort=null}=props;const
id=useId();const collectionList=props.collectionList?.[0];const emptyState=props.emptyState?.[0];const isCanvas=RenderTarget.current()===RenderTarget.canvas;const isOptimizing=typeof window==="undefined";const scrollUpRef=useRef(null);const itemCountRef=useRef(-1);const
isFirstRender=useRef(true);const{query,queryParent,propertyControlsById,propertyControlsByTitle,childrenFunction,collections,multiReferenceQueries,multiReferenceIdMap}=useMemo(()=>getCollectionData(collectionList),[collectionList]);const mainCollection=collections[0];const
framerPaginationSize=isCanvas?0:queryParent?.props?.pageSize||0;const framerPagination=framerPaginationSize>0;const paginationActive=framerPagination||props.pagination;const[filters,randomizationSeed,search,sortOption,defaultSortOption,sortingUrlParameter,paginationType,itemsPerPage,page,setPage,setTotalItems,paginationButtonsCount,storeSearchFields,setPaginationType]=useSuperfieldsStore(superfieldsId,state=>[state.filters,state.randomizationSeed,state.search,state.sortOption,state.defaultSortOption,state.sortingUrlParameter,state.paginationType,state.itemsPerPage,state.page,state.setPage,state.setTotalItems,state.paginationButtonsCount,state.searchFields,state.setPaginationType],state=>{state.itemsPerPage=framerPagination?framerPaginationSize:props.pagination?props.itemsPerPage:0;state.paginationActive=paginationActive;//
Only set searchFields if not already set in store // This can also be set from the SearchBar. If that happens, it should take precedence. if(!state.searchFields){state.searchFields=props.searchFields;}if(!isOptimizing&&!isCanvas){if(props.randomize){state.randomizationSeed=Math.floor(Math.random()*1e8);}const
urlParams=new URLSearchParams(window.location.search);if(urlParameters?.search&&urlParameters.searchName){const searchParam=urlParams.get(urlParameters.searchName);if(searchParam){state.search=searchParam;}}if(urlParameters?.pagination&&urlParameters.paginationName){const
pageParam=urlParams.get(urlParameters.paginationName);if(pageParam){const parsedPage=parseInt(pageParam,10);const maxPages=Math.ceil(data.length/state.itemsPerPage);if(!isNaN(parsedPage)&&parsedPage>=1&&parsedPage
<=maxPages){state.page=parsedPage-1//
    Convert to 0-based index ;}}}}});// Calculate paginationType dynamically based on paginationButtonsCount const calculatedPaginationType=useMemo(()=>{return paginationButtonsCount>0?"prevNextButtons":framerPagination?"framerPagination":props.pagination?props.paginationType:null;},[paginationButtonsCount,framerPagination,props.pagination,props.paginationType]);// Update the store's paginationType when
    calculatedPaginationType changes useEffect(()=>{setPaginationType(calculatedPaginationType);},[calculatedPaginationType,setPaginationType]);const randomize=props.randomize||(randomizationSeed?true:false);const mainAlias=mainCollection?.alias;const
    mainPropertyControlsByTitle=propertyControlsByTitle[mainAlias]||{};const mainPropertyControlsById=propertyControlsById[mainAlias]||{};const slugFieldId=mainPropertyControlsByTitle[slugFieldName||"Slug"]?.id;const filterIds=Object.keys(filters);let
    sort=props.sorting?sortingField:null;if(sortOption&&sortOption.id!==DEFAULT_SORTING_ID){sort=sortOption;}const favourites=useFavouriteStore(slugFieldId,state=>state.favourites,cmsCollectionName);// Use storeSearchFields if available, otherwise use
    props.searchFields const finalSearchFields=storeSearchFields||props.searchFields;const select=useMemo(()=>{return modifySelect(query,filters,props.search,finalSearchFields,sort,propertyControlsByTitle,collections);},[query,filters,props.search,finalSearchFields,sort?.sortBy,sort?.fieldName]);const
    multiReferenceSelects=useMemo(()=>{const selects={};for(const alias of Object.keys(multiReferenceQueries)){// const cmsFieldsForCollection = [] // for (const fieldId of Object.keys(mainPropertyControlsById)) { // const field = mainPropertyControlsById[fieldId]
    // // if (field?.title) // } let cmsField=mainPropertyControlsById[alias];if(!cmsField){for(const key of Object.keys(multiReferenceIdMap)){if(multiReferenceIdMap[key]===alias){cmsField=mainPropertyControlsById[key];break;}}}if(cmsField){const fieldTitle=cmsField.title;const
    referenceSearchFields=[];for(const searchField of finalSearchFields){if(searchField.fieldType==="reference"&&searchField.fieldName===fieldTitle){referenceSearchFields.push({fieldName:searchField.referenceFieldName,fieldType:"default"});}}const referenceFilters={};for(const
    filterId of Object.keys(filters)){const filter=filters[filterId];if(filter.fieldType===FilterFieldType.MultiReference&&filter.fieldName===fieldTitle){referenceFilters[filterId]={...filter,fieldName:filter.referenceFieldName,fieldType:filter.referenceFieldType,referenceFieldName:undefined,referenceFieldType:undefined};}}selects[alias]=modifySelect(multiReferenceQueries[alias],referenceFilters,props.search,referenceSearchFields,null,propertyControlsByTitle,[...collections].sort((a,b)=>a.alias===alias?-1:b.alias===alias?1:0));}else{const
    rQuery=multiReferenceQueries[alias];if(rQuery){selects[alias]=rQuery.select;}}}return selects;},[multiReferenceQueries,filters,props.search,finalSearchFields]);const originalData=query?useQueryData({...query,select}):[];const multiReferenceItemsById={};for(const
    fieldId of Object.keys(multiReferenceQueries)){const refSelect=multiReferenceSelects[fieldId];const refQuery=multiReferenceQueries[fieldId];const refDataItemsById={};if(refSelect&&refQuery){const refData=useQueryData({...refQuery,select:refSelect,where:undefined,orderBy:undefined});for(const
    item of refData){refDataItemsById[item.id]=item;}}multiReferenceItemsById[fieldId]=refDataItemsById;}const[data,dataIds,dataItemsById]=useMemo(()=>{const data=mapCollectionDataValues(originalData,propertyControlsById,mainAlias,multiReferenceItemsById,multiReferenceIdMap);const
    dataIds=originalData.map(item=>item.id);const dataItemsById={};if(!isCanvas&&Array.isArray(data)){for(const item of data){dataItemsById[item.id]=item;}}return[data,dataIds,dataItemsById];},[originalData,propertyControlsById,mainAlias,multiReferenceItemsById,multiReferenceIdMap]);const
    scrollToTop=()=>{if(scrollUp&&scrollUpRef.current&&!isOptimizing&&!isCanvas){const rect=scrollUpRef.current.getBoundingClientRect();const topIsInView=rect.top>=0&&rect.top
    <=window.innerHeight;if(!topIsInView){scrollUpRef.current.scrollIntoView({behavior:scrollUp.scrollStyle});}}};useEffect(()=>{if(isFirstRender.current){return;}if(scrollUp&&(scrollUp.filteringEnabled&&filterIds.length>0||scrollUp.sortingEnabled&&sort?.sortBy!=="defaultSorting")){scrollToTop();}},[filters,sort?.sortBy]);useEffect(()=>{if(isFirstRender.current){isFirstRender.current=false;return;}if(paginationActive&&scrollUp&&scrollUp.paginationEnabled&&paginationType=="prevNextButtons"){scrollToTop();}//
        Update URL parameter if(paginationActive&&urlParameters?.pagination&&urlParameters.paginationName&&!isOptimizing){const url=new URL(window.location.href);const pageNumber=page+1// Convert to 1-based ;if(pageNumber>1){url.searchParams.set(urlParameters.paginationName,pageNumber.toString());}else{url.searchParams.delete(urlParameters.paginationName);}window.history.replaceState({path:url.href},"",url.href);}},[page,paginationActive,paginationType,urlParameters]);useEffect(()=>{if(!urlParameters?.search||!urlParameters.searchName||isCanvas||isOptimizing){return;}const
        url=new URL(window.location.href);if(search){url.searchParams.set(urlParameters.searchName,search);}else{url.searchParams.delete(urlParameters.searchName);}window.history.replaceState({path:url.href},"",url.href);},[search,urlParameters]);useEffect(()=>{if(isCanvas||isOptimizing){return;}const
        url=new URL(window.location.href);let hasUrlParameterFilter=false;for(const filterId of filterIds){const filter=filters[filterId];if(filter&&filter.urlParameter){hasUrlParameterFilter=true;const value=filter.value;if(value!=null&&value!==undefined&&value!==""){url.searchParams.set(filter.urlParameter,value.toString());}else{url.searchParams.delete(filter.urlParameter);}}}if(hasUrlParameterFilter){window.history.replaceState({path:url.href},"",url.href);}},[filters,urlParameters]);useEffect(()=>{if(isCanvas||isOptimizing||!sortingUrlParameter){return;}const
        url=new URL(window.location.href);if(sortOption&&sortOption.title!==defaultSortOption?.title){url.searchParams.set(sortingUrlParameter,sortOption.title);}else{url.searchParams.delete(sortingUrlParameter);}window.history.replaceState({path:url.href},"",url.href);},[sortOption,defaultSortOption,sortingUrlParameter]);//
        Filtering const filteredData=useMemo(()=>{if(isCanvas||!filterIds.length){return dataIds;}let itemIds=dataIds;for(const filterId of filterIds){if(filterId==FAVOURITES_FILTER_ID){continue;}const filter=filters[filterId];const{fieldName,fieldType}=filter;const
        filterValue=filter.value;const conditionContains=filter?.condition===FilterTextCondition.Contains;const fields=[];if(fieldType===FilterFieldType.MultipleOptions){for(const n of fieldName.split(DELIMITER)){const field=mainPropertyControlsByTitle[n.trim()];if(field){fields.push(field);}}}else
        if(fieldType===FilterFieldType.Reference||fieldType===FilterFieldType.MultiReference){const{referenceFieldName}=filter;const field=mainPropertyControlsByTitle[fieldName];const isMultiRef=field?.type==="multicollectionreference";if(field&&(field.type==="collectionreference"||isMultiRef)){const
        collection=collections.find(c=>c.alias===field.id||isMultiRef&&c.alias===multiReferenceIdMap[field.id]);const collectionPropControls=collection?.data?.propertyControls;if(collectionPropControls){let propertyControlId=null;let propertyControl=null;for(const
        propertyId of Object.keys(collectionPropControls)){const control=collectionPropControls[propertyId];if(control.title===referenceFieldName){propertyControlId=propertyId;propertyControl=control;break;}}if(propertyControl&&propertyControlId){if(isMultiRef){fields.push({...field,referenceAlias:multiReferenceIdMap[field.id],referenceId:propertyControlId,referenceType:propertyControl.type});}else{fields.push({id:`${field.id}.${propertyControlId}`,type:propertyControl.type});}}}}}else{const
        field=mainPropertyControlsByTitle[fieldName];if(field){fields.push(field);}}const isMultipleFields=fields.length>1;if(filter&&fields.length&&filterValue!=null&&filterValue!=undefined){const filteredData=[];for(const id of itemIds){let foundMatch=false;const
        dataItem=dataItemsById[id];if(isMultipleFields){for(const field of fields){if(processField(field,dataItem[field.id],filterValue,filter.multiSelect,conditionContains,multiReferenceItemsById)){foundMatch=true;break;}}}else{const field=fields[0];foundMatch=processField(field,dataItem[field.id],filterValue,filter.multiSelect,conditionContains,multiReferenceItemsById);}if(foundMatch){filteredData.push(id);}}itemIds=filteredData;}}return
        itemIds;},[filters,data]);// Favourites filter const favouriteFilterValue=filters[FAVOURITES_FILTER_ID]?.value;const favouriteFilteredData=useMemo(()=>{if(isCanvas||!slugFieldId||!favouritesOnly&&typeof favouriteFilterValue!==FieldType.Boolean){return
        dataIds;}const shouldFilterFavorites=favouriteFilterValue===true||favouritesOnly;if(!Array.isArray(favourites)||favourites.length===0){if(shouldFilterFavorites){return[];}}else{return dataIds.filter(id=>favourites.includes(dataItemsById[id][slugFieldId])===shouldFilterFavorites);}return
        dataIds;},[favouriteFilterValue,favouritesOnly,favourites,data]);const customFilteredData=useMemo(()=>{if(!customOverrideFilter){return dataIds;}const value=customOverrideFilter({dataIds,dataItemsById,collections,propertyControlsById,propertyControlsByTitle,mainPropertyControlsByTitle});if(Array.isArray(value)){return
        value;}return dataIds;},[customOverrideFilter,data]);// Search const searchText=search?.trim().toLowerCase()??"";const[searchData,hasSearch,missingSearchField]=useMemo(()=>{if(isCanvas||!searchText.length||!Array.isArray(data)){return[dataIds,false,null];}let
        missingFieldName=null;// 0: Hidden // 1: Includes text // 2: Includes full word // 3: Starts with // 4: Exact match const levels=[[...dataIds],[],[],[],[]];const itemLevels=new Array(data.length).fill(0);for(let i=0;i
        <finalSearchFields.length;i++){const{fieldType,fieldName,referenceFieldName}=finalSearchFields[i];const{property}=getPropertyControl(fieldName,fieldType,referenceFieldName,null,propertyControlsByTitle,mainAlias,
            "Title");if(!property){missingFieldName=fieldName;break;}const propertyID=property.id;const propertyType=property.type;const propIsString=propertyType==FieldType.String||propertyType==FieldType.Enum;const propIsNumber=propertyType==FieldType.Number;const
            propIsMultiReference=propertyType=="multicollectionreference" ;for(const ii in data){const cmsItem=data[ii];let level=0;if(propIsMultiReference){const items=dataItemsById[cmsItem.id]?.[propertyID];const alias=multiReferenceIdMap[property.id];const
            propertyControls=propertyControlsByTitle[alias];if(propertyControls&&typeof propertyControls==="object" &&Array.isArray(items)){const rPropertyControl=propertyControls[referenceFieldName|| "Title"];const propId=rPropertyControl?.id;if(propId){for(const
            rItem of items){if(rItem){const rValue=rItem[propId];level=Math.max(level,getSearchLevelForValue(rValue,searchText));}}}}}else{const value=dataItemsById[cmsItem.id]?.[propertyID];level=getSearchLevelForValue(value,searchText);}// Move item to
            new level if it
            's a higher level
const oldLevel=itemLevels[ii];if(level>oldLevel){// Remove from old level
const oldLevelItems=[];for(const item of levels[oldLevel]){if(item!=cmsItem.id){oldLevelItems.push(item);}}levels[oldLevel]=oldLevelItems;// Add to new level
levels[level].push(cmsItem.id);itemLevels[ii]=level;}}}if(missingFieldName){return[dataIds,false,missingFieldName];}return[[...levels[4],...levels[3],...levels[2],...levels[1]],true,missingFieldName];},[searchText,data,finalSearchFields]);// Pagination, randomization and sorting are applied after filtering and search
let itemIds=searchData.filter(itemId=>filteredData.includes(itemId)&&favouriteFilteredData.includes(itemId)&&customFilteredData.includes(itemId));const itemCount=itemIds.length;const pageCount=itemsPerPage&&itemCount?Math.ceil(itemCount/itemsPerPage):1;if(itemCount!==itemCountRef.current){setTotalItems(itemCount);}itemCountRef.current=itemCount;// Randomization
const dataOrder=useMemo(()=>{if(randomizationSeed&&!isCanvas&&Array.isArray(data)){const newDataOrder=Array.from({length:data.length},(_,i)=>i);return shuffle(newDataOrder,randomizationSeed);}return null;},[randomizationSeed,isCanvas,data]);if(!isCanvas&&!hasSearch&&randomize){let orderedItemIds=dataIds;if(dataOrder){orderedItemIds=new Array(dataIds.length);for(let i=0;i<dataOrder.length;i++){orderedItemIds[dataOrder[i]]=dataIds[i];}}itemIds=orderedItemIds.filter(itemId=>itemIds.includes(itemId));}const canSort=!isCanvas&&!randomize&&!hasSearch;let missingSortField="";let mismatchedSortFieldName="";let mismatchedSortFieldType="";if(canSort&&sort&&sort.sortBy!=="defaultSorting"){const{sortBy}=sort;const isReference=sort.fieldType==="reference";const fieldType=isReference?sort.referenceFieldType:sort.fieldType;const{property,mismatchedFieldName,mismatchedFieldType}=getPropertyControl(sort.fieldName,sort.fieldType,sort.referenceFieldName,sort.referenceFieldType,propertyControlsByTitle,mainAlias);if(mismatchedFieldName){mismatchedSortFieldName=mismatchedFieldName;mismatchedSortFieldType=mismatchedFieldType;}else{const fieldId=property?.id;if(sortBy==="field"&&fieldId||sortBy==="favourites"&&slugFieldId){const isAscending=sortBy==="favourites"?sort.favouritesSort==="favouritesLast":fieldType===FieldType.String&&sort.stringSort==="ascending"||fieldType===FieldType.Number&&sort.numberSort==="ascending"||fieldType===FieldType.Date&&sort.dateSort==="ascending"||fieldType===FieldType.Boolean&&sort.booleanSort==="noYes"||fieldType===FieldType.Enum&&(sort.enumSort==="optionOrder"||sort.enumSort==="ascending");const getSortValue=id=>{if(sortBy==="favourites"){const slug=dataItemsById[id]?.[slugFieldId];return Array.isArray(favourites)&&favourites.includes(slug)?1:0;}const value=dataItemsById[id]?.[fieldId];if(value==null){return null;}switch(fieldType){case FieldType.Number:return Number(value);case FieldType.Date:return new Date(value).getTime();case FieldType.Boolean:return value?1:0;case FieldType.Enum:return sort.enumSort==="optionOrder"||sort.enumSort==="reverseOptionOrder"?property.optionTitles?property.optionTitles.indexOf(value):-1:String(value);default:return String(value);}};const sortedItemIds=[...itemIds].sort((a,b)=>{const aValue=getSortValue(a);const bValue=getSortValue(b);if(aValue===null&&bValue===null)return 0;if(aValue===null)return 1;if(bValue===null)return-1;let comparison;if(fieldType===FieldType.String||fieldType===FieldType.Enum&&(sort.enumSort==="ascending"||sort.enumSort==="descending")){comparison=aValue.localeCompare(bValue);}else{comparison=aValue<bValue?-1:aValue>bValue?1:0;}return isAscending?comparison:-comparison;});itemIds=sortedItemIds;}else{missingSortField=sort.fieldName;}}}if(canSort&&customOverrideSort){const value=customOverrideSort({itemIds,dataItemsById,collections,propertyControlsById,propertyControlsByTitle});if(Array.isArray(value)){itemIds=value;}}// Pagination
if(!isCanvas&&paginationActive){switch(paginationType){case"prevNextButtons":itemIds=itemIds.slice(page*itemsPerPage,(page+1)*itemsPerPage);break;case"loadMoreButton":case"framerPagination":itemIds=itemIds.slice(0,(page+1)*itemsPerPage);break;}}const memoizedChildren=useMemo(()=>{if(isCanvas||!collectionList||!query||!childrenFunction){return null;}const{offset,limit}=query;const paginationInfo={currentPage:page+1,totalPages:pageCount,isLoading:false};const loadMore=()=>{if(paginationActive){const newPage=page+1;if(newPage>=0&&newPage<pageCount){setPage(newPage);}}};const originalDataItemsById={};for(const item of originalData){originalDataItemsById[item.id]=item;}const items=itemIds.map(itemId=>originalDataItemsById[itemId]).filter(Boolean);let clChildren=childrenFunction(items,paginationInfo,loadMore);const modifyChildren=elements=>{let newChildren=elements;if(Array.isArray(elements)&&elements.length&&componentConfig&&componentConfig.variant.length>0){const componentChildren=[];let isComponentWithVariants=true;for(let i=0;i<elements.length;i++){const child=elements[i];const key=child.key??child.props?.id;const component=/*#__PURE__*/_jsx(MemoizedComponentVariantSwitch,{child:child,componentConfig:componentConfig},key);if(component===child){isComponentWithVariants=false;break;}else{componentChildren.push(/*#__PURE__*/_jsx(LayoutGroup,{id:key,children:component},key));}}if(isComponentWithVariants){newChildren=componentChildren;}}let result=[];// Add layout transitions
for(let i=0;i<newChildren.length;i++){const child=newChildren[i];const key=child.key??child.props?.id;const isVertical=layout?.direction=="vertical";result.push(/*#__PURE__*/_createElement(motion.div,{// Motion Layout Props
layout:"position",layoutId:key,...child.props||{},style:{...child.props.style||{},width:isVertical?props.style?.width:undefined},key:key}));}return result;};let children=null;if(Array.isArray(clChildren)){children=modifyChildren(clChildren);}else if(Array.isArray(clChildren?.props?.children)){const childrenArray=clChildren.props.children;let arrayIndex=childrenArray.findIndex(child=>Array.isArray(child));if(arrayIndex==-1){children=modifyChildren(childrenArray);}else{let newChildren=[];for(const child of childrenArray){if(Array.isArray(child)){newChildren=newChildren.concat(modifyChildren(child));}else{newChildren.push(child);}}children=newChildren;}}const childrenSlugs=[];if(Array.isArray(children)){for(const child of children){let slug=null;const id=child.props?.child?.key;if(id){slug=dataItemsById[id]?.[slugFieldId];}childrenSlugs.push(slug);}}return children.map((child,index)=>/*#__PURE__*/_jsx(PathVariablesContext.Provider,{value:{[slugFieldId]:childrenSlugs[index]||null},children:child}));},[isCanvas,collectionList,query,itemIds,page,componentConfig]);if(!collectionList){return /*#__PURE__*/_jsx(Message,{title:"Connect a CMS Collection List",subtitle:"Drag the handle on the right side to a Collection List or select from the dropdown list. The Collection List must be outside of a page to be connected."});}else if(!isCanvas&&!query){return /*#__PURE__*/_jsx(Message,{title:"Connect a CMS Collection List",subtitle:"The layer that's connected isn 't a Collection List. Make sure the Collection List isn't inside of any other layers or components when connecting it. "});}else if(missingSearchField){return /*#__PURE__*/_jsx(Message,{title:`"${missingSearchField}
            " field does not exist in your CMS collection`,subtitle:`The field "${missingSearchField}
            " is in the search fields list, but there are no fields in your CMS collection with that name. Edit the field name in the search fields list or add a new CMS field with that name.`});}else if(missingSortField){return /*#__PURE__*/_jsx(Message,{title:`"${missingSortField} " field does not exist in your CMS collection`,subtitle:`The field "${missingSortField}
            " is in the search fields list, but there are no fields in your CMS collection with that name. Edit the field name in the sorting configuration or add a new CMS field with that name.`});}else if(mismatchedSortFieldName){return /*#__PURE__*/_jsx(Message,{title:`"${mismatchedSortFieldName} " is not a ${fieldTypeNames[mismatchedSortFieldType]||mismatchedSortFieldType} field.`,subtitle:"Please update the Superfields sorting mode to match the field type on the CMS collection
            "});}let layoutStyle={};if(layout){switch(layout.type){case"stack ":const isVertical=layout.direction=="vertical ";layoutStyle={display:"flex ",flexDirection:isVertical?"column ":"row ",flexWrap:layout.wrap?"wrap ":"nowrap
            ",alignItems:isVertical?layout.alignV:layout.alignH,justifyContent:layout.distribute,gap:layout.gap};break;case"grid ":// Columns
let gridTemplateColumns=" ";if(layout.columns=="auto "){if(layout.gridWidthType=="min "){gridTemplateColumns=`repeat(auto-fill, minmax(${layout.gridWidth}px, 1fr))`;}else{// "fixed "
gridTemplateColumns=`repeat(auto-fill, ${layout.gridWidth}px)`;}}else{if(layout.gridWidthType=="min "){gridTemplateColumns=`repeat(${layout.columnCount}, minmax(${layout.gridWidth}px, 1fr))`;}else{// "fixed "
gridTemplateColumns=`repeat(${layout.columnCount}, ${layout.gridWidth}px)`;}}// Rows
let gridAutoRows=" ";switch(layout.gridHeightType){case"fixed ":gridAutoRows=`${layout.gridHeight}px`;break;case"fit ":gridAutoRows="min-content ";break;}layoutStyle={display:"grid
            ",gridTemplateColumns,gridAutoRows,justifyContent:layout.gridAlign,alignItems:layout.gridAlignV,columnGap:layout.gapH,rowGap:layout.gapV};break;}}const isMasonry=layout?.type==="masonry ";const collectionListStyle={...isMasonry?{}:collectionList.props?.style,...props.style,...layoutStyle,position:"relative
            ",padding:layout?layout.paddingIsMixed?`${layout.paddingTop}px ${layout.paddingRight}px ${layout.paddingBottom}px ${layout.paddingLeft}px`:`${layout.padding}px`:undefined};const masonryProps=isMasonry?{columns:layout.masonryColumns,gapH:layout.gapH,gapV:layout.gapV,alignment:layout.masonryItemWidth==="fit "?layout.masonryAlign:"stretch ",autoArrange:true,reverse:false}:{};// Canvas view
if(isCanvas){if(collectionList){let paginationPreviewOffset=0;let paginationItemsAfter=0;if(paginationActive&&paginationType!=="framerPagination "){try{// const children = collectionList.type.type(collectionList.props).props.children.props
// 	.children;
// if (children.length > 1) {
// 	for (let i = 0; i < children.length; i++) {
// 		if (children[i].key == "repeated ") {
// 			paginationPreviewOffset = i;
// 			paginationItemsAfter = children.length - i - 1;
// 			break;
// 		}
// 	}
// }
}catch{console.warn("Failed to calculate Superfields pagination preview offset. ");}}if(isMasonry){return /*#__PURE__*/_jsx(Message,{title:"Preview site to view masonry layout ",subtitle:"The CMS masonry layout is not available in the editor. Preview
            or publish your site to see the CMS items. "});// const htmlElement = collectionList.props?.__node?.cache?.htmlElement;
// if (htmlElement) {
// 	let reactFiberKey = " ";
// 	for (const key of Object.keys(htmlElement)) {
// 		if (key.startsWith("__reactFiber ")) {
// 			reactFiberKey = key;
// 		}
// 	}
// 	// Solution for getting React children from CMS collection on canvas by Fehmi Ozuseven
// 	let cmsChildren =
// 		htmlElement[reactFiberKey]?.memoizedProps?.children?.[0]?.props?.children?.props
// 			?.children?.[1]?.props?.children?.[0]?.props?.children;
// 	console.log(cmsChildren);
// 	if (Array.isArray(cmsChildren)) {
// 		let children = [];
// 		for (const child of cmsChildren) {
// 			if (child.key == "repeated " && Array.isArray(child.props?.children)) {
// 				children = children.concat(child.props.children);
// 			} else {
// 				children.push(child);
// 			}
// 		}
// 		return (
// 			<div data-superfields style={collectionListStyle}>
// 				<MemoizedMasonry {...masonryProps}>{children}</MemoizedMasonry>
// 			</div>
// 		);
// 	}
// }
}else{const id=props.id??"a "+String(Math.floor(Math.random()*999999999));return /*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/cloneElement(collectionList,{id,style:collectionListStyle}),paginationActive&&paginationType!=="framerPagination
            "&&/*#__PURE__*/_jsx("style ",{children:`#${id} > *:nth-child(n+${itemsPerPage+1+paginationPreviewOffset})${paginationItemsAfter?`:not(:nth-last-child(-n+${paginationItemsAfter}))`:" "} { display: none !important; }`})]});}}else{return /*#__PURE__*/_jsx("div ",{style:{height:100}});}}// Empty state
if(!itemIds?.length){if(emptyState){return /*#__PURE__*/cloneElement(emptyState,{style:{...emptyState.props.style,...props.style},"data-superfields ":true});}else{return /*#__PURE__*/_jsx("div ",{"data-superfields
            ":true});}}return /*#__PURE__*/_jsxs("div ",{...collectionList.props,style:collectionListStyle,className:isMasonry?" ":collectionList.props?.className||" ","data-superfields
            ":true,children:[/*#__PURE__*/_jsx(LayoutGroup,{id:id,children:/*#__PURE__*/_jsx(Transition,{value:transition,children:isMasonry?/*#__PURE__*/_jsx(MemoizedMasonry,{...masonryProps,children:memoizedChildren}):memoizedChildren})}),paginationActive&&scrollUp&&/*#__PURE__*/_jsx("div ",{ref:scrollUpRef,style:{position:"absolute ",top:scrollUp.offset,pointerEvents:"none "}})]});}addPropertyControls(Superfields,{superfieldsId:{type:ControlType.Number,defaultValue:0,step:1,min:0,displayStepper:true,title:"ID
            "},collectionList:{type:ControlType.ComponentInstance},emptyState:{type:ControlType.ComponentInstance},layout:{type:ControlType.Object,optional:true,controls:{type:{type:ControlType.Enum,defaultValue:"stack ",options:["stack ","grid ","masonry "],optionTitles:["Stack ","Grid ","Masonry "],displaySegmentedControl:true,segmentedControlDirection:"vertical "},direction:{type:ControlType.Enum,defaultValue:"vertical ",options:["horizontal ","vertical
            "],optionTitles:["Horizontal ","Vertical "],optionIcons:["direction-horizontal ","direction-vertical "],displaySegmentedControl:true,hidden:props=>props.type!="stack "},distribute:{type:ControlType.Enum,defaultValue:"start ",options:["start ","center ","end
            ","space-between ","space-around ","space-evenly "],optionTitles:["Start ","Center ","End ","Space Between ","Space Around ","Space Evenly "],hidden:props=>props.type!="stack "},alignH:{type:ControlType.Enum,defaultValue:"start ",options:["start
            ","center ","end "],optionTitles:["Top ","Center ","Bottom "],optionIcons:["align-top ","align-middle ","align-bottom "],displaySegmentedControl:true,title:"Align ",hidden:props=>props.type!="stack "||props.direction!="horizontal
            "},alignV:{type:ControlType.Enum,defaultValue:"start ",options:["start ","center ","end "],optionTitles:["Left ","Center ","Right "],optionIcons:["align-left ","align-center ","align-right "],displaySegmentedControl:true,title:"Align ",hidden:props=>props.type!="stack
            "||props.direction!="vertical "},wrap:{type:ControlType.Boolean,defaultValue:false,hidden:props=>props.type!="stack "},columns:{type:ControlType.Enum,defaultValue:"fixed ",options:["auto ","fixed "],optionTitles:["Auto ","Fixed
            "],displaySegmentedControl:true,hidden:props=>props.type!="grid "},columnCount:{type:ControlType.Number,defaultValue:2,min:1,step:1,displayStepper:true,title:" ",hidden:props=>props.type!="grid "||props.columns=="auto "},gridWidthType:{type:ControlType.Enum,defaultValue:"min ",options:["min ","fixed
            "],optionTitles:["Min ","Fixed "],displaySegmentedControl:true,title:"Width ",hidden:props=>props.type!="grid "},gridWidth:{type:ControlType.Number,defaultValue:200,min:1,step:1,title:" ",hidden:props=>props.type!="grid
            "},gridHeightType:{type:ControlType.Enum,defaultValue:"fit ",options:["fit ","fixed "],optionTitles:["Fit ","Fixed "],displaySegmentedControl:true,title:"Height ",hidden:props=>props.type!="grid "},gridHeight:{type:ControlType.Number,defaultValue:200,min:1,step:1,title:"
            ",hidden:props=>props.type!="grid "||props.gridHeightType!="fixed "},gridAlign:{type:ControlType.Enum,defaultValue:"center ",options:["start ","center ","end "],optionTitles:["Left ","Center ","Right "],displaySegmentedControl:true,title:"Align
            ",hidden:props=>props.type!="grid "},gridAlignV:{type:ControlType.Enum,defaultValue:"start ",options:["start ","center ","end "],optionTitles:["Top ","Center ","Bottom "],optionIcons:["align-top ","align-middle ","align-bottom "],displaySegmentedControl:true,title:"
            ",hidden:props=>props.type!="grid "||props.gridHeightType!=="fit "},masonryColumns:{type:ControlType.Number,defaultValue:3,min:1,step:1,displayStepper:true,title:"Columns ",hidden:props=>props.type!=="masonry "},masonryItemWidth:{type:ControlType.Enum,defaultValue:"fill
            ",options:["fit ","fill "],optionTitles:["Fit ","Fill "],displaySegmentedControl:true,title:"Item Width ",hidden:props=>props.type!=="masonry "},masonryAlign:{type:ControlType.Enum,defaultValue:"center ",options:["start ","center ","end
            "],optionTitles:["Left ","Center ","Right "],displaySegmentedControl:true,title:"Align ",hidden:props=>props.type!=="masonry "||props.masonryItemWidth!=="fit "},gap:{type:ControlType.Number,defaultValue:10,min:0,step:1,hidden:props=>props.type!=="stack
            "},gapH:{type:ControlType.Number,defaultValue:10,min:0,step:1,hidden:props=>props.type!=="grid "&&(props.type!=="masonry "||props.masonryColumns===1)},gapV:{type:ControlType.Number,defaultValue:10,min:0,step:1,hidden:props=>props.type!=="grid "&&props.type!=="masonry
            "},padding:{type:ControlType.FusedNumber,defaultValue:0,toggleKey:"paddingIsMixed ",toggleTitles:["All ","Individual "],valueKeys:["paddingTop ","paddingRight ","paddingBottom ","paddingLeft "],valueLabels:["T ","R ","B ","L "],min:0}}},componentConfig:{type:ControlType.Object,optional:true,title:"Component
            ",controls:{variant:{type:ControlType.String,defaultValue:" ",placeholder:"Variant Name ",preventLocalization:true,description:"Override the component
            's variant for responsive design.\n\n*Note:* The component must be the only layer inside the Collection List to use this.\n\n*Note:* Variant does not appear while editing. Preview your project to see the variant."}}},scrollUp:{type:ControlType.Object,optional:true,defaultValue:{scrollStyle:"smooth",offset:0},title:"Scroll to Top",controls:{scrollStyle:{type:ControlType.Enum,defaultValue:"smooth",options:["smooth","instant"],optionTitles:["Smooth","Instant"],displaySegmentedControl:true,title:"Scroll"},offset:{type:ControlType.Number,defaultValue:-32,step:1,description:" "},paginationEnabled:{type:ControlType.Boolean,defaultValue:true,title:"Pagination"},filteringEnabled:{type:ControlType.Boolean,defaultValue:false,title:"Filters"},sortingEnabled:{type:ControlType.Boolean,defaultValue:false,title:"Sorting",description:"Scroll to the top of the Superfields component when page, filter, or sorting is changed."}}},transition:{type:ControlType.Transition,defaultValue:{type:false},description:" "},// urlParameters: {
//     type: ControlType.Object,
//     title: "URL Parameters",
//     description: " ",
//     controls: {
//         pagination: {
//             type: ControlType.Boolean,
//             defaultValue: false,
//         },
//         paginationName: {
//             type: ControlType.String,
//             defaultValue: "page",
//             placeholder: "URL Parameter",
//             title: "Name",
//             description: "Current page",
//             hidden: (props) => !props.pagination,
//         },
//         search: {
//             type: ControlType.Boolean,
//             defaultValue: false,
//         },
//         searchName: {
//             type: ControlType.String,
//             defaultValue: "search",
//             placeholder: "URL Parameter",
//             title: "Name",
//             description: "Search input text",
//             // "Search input text\n\n*Note:* URL parameters for filters and sorting can be added on the Filter and Sorting Selector components.",
//             hidden: (props) => !props.search,
//         },
//     },
// },
pagination:{type:ControlType.Boolean,defaultValue:false},paginationType:{type:ControlType.Enum,defaultValue:"pagination",options:["prevNextButtons","loadMoreButton"],optionTitles:["Prev/Next Buttons","Load More Button"],title:"Type",displaySegmentedControl:true,segmentedControlDirection:"vertical",hidden:props=>!props.pagination},itemsPerPage:{type:ControlType.Number,defaultValue:4,min:1,step:1,displayStepper:true,hidden:props=>!props.pagination},filtering:{type:ControlType.Boolean,defaultValue:false},favouriting:{type:ControlType.Boolean,defaultValue:false},favouritesOnly:{type:ControlType.Boolean,defaultValue:false,hidden:props=>!props.favouriting},search:{type:ControlType.Boolean,defaultValue:false},searchFields:{type:ControlType.Array,defaultValue:[{fieldType:"default",fieldName:"Title"}],title:"Fields",control:{type:ControlType.Object,controls:{fieldType:{type:ControlType.Enum,defaultValue:"default",options:["reference","default"],optionTitles:["Yes","No"],displaySegmentedControl:true,title:"Reference"},fieldName:{type:ControlType.String,defaultValue:"Title",placeholder:"CMS Field Name",preventLocalization:true},referenceFieldName:{type:ControlType.String,defaultValue:"",placeholder:"CMS Field Name",preventLocalization:true,hidden:props=>props.fieldType!=="reference"}}},description:"CMS fields to search",hidden:props=>!props.search},randomize:{type:ControlType.Boolean,defaultValue:false},sorting:{type:ControlType.Boolean,defaultValue:false,hidden:props=>props.randomize},sortingField:{type:ControlType.Object,optional:true,hidden:props=>props.randomize||!props.sorting,controls:sortingControls()},slugFieldName:{type:ControlType.String,defaultValue:"Slug",placeholder:"Slug Field Name",preventLocalization:true,hidden:props=>!props.favouriting&&!props.sorting},cmsCollectionName:{type:ControlType.String,defaultValue:"",preventLocalization:true,hidden:props=>true}});function ComponentVariantSwitch({child,componentConfig}){const componentChild=child?.props?.children?.props?.children;const componentProps=componentChild?.props;const component=componentProps?.children;const variant=componentConfig.variant;if(!component){return child;}const clonedComponent=cloneComponent(componentChild,variant);if(clonedComponent){return clonedComponent;}if(componentProps&&typeof componentProps==="object"&&componentProps?.hasOwnProperty("href")){const clonedChild=cloneComponent(componentProps.children?.props?.children,variant);if(clonedChild){return /*#__PURE__*/cloneElement(componentChild,{children:{...componentProps?.children,props:{...componentProps?.children?.props,children:clonedChild}}});}}const clonedChild=cloneComponent(componentProps?.children,variant);if(clonedChild){return /*#__PURE__*/cloneElement(componentChild,{children:clonedChild});}if(clonedComponent?.props?.hasOwnProperty("variant")){return /*#__PURE__*/cloneElement(component,{variant});}return child;}const MemoizedComponentVariantSwitch=/*#__PURE__*/memo(ComponentVariantSwitch);const MemoizedMasonry=/*#__PURE__*/memo(Masonry);function cloneComponent(componentChild,variant){const componentProps=componentChild?.props;const component=componentProps?.children;if(componentChild?.type==ResolveLinks){return /*#__PURE__*/_jsx(ResolveLinks,{...componentProps,children:(...values)=>{const element=component(...values);return /*#__PURE__*/cloneElement(element,{children:{...element.props.children,props:{...element.props.children.props,children:{...element.props.children.props.children,props:{...element.props.children.props.children.props,variant}}}}});}});}else if(!component?.type?.propertyControls){const cData=component?.props?.children;if(component&&cData){const variantProp=cData.type?.propertyControls?.variant;if(variantProp){return /*#__PURE__*/cloneElement(component,{children:{...cData,props:{...cData.props,variant}}});}}}return null;}function shuffle(array,seed){// Create a copy of the original array to avoid modifying it directly
const shuffled=array.slice();// Create a seeded random number generator
let currentSeed=seed;const random=()=>{const x=Math.sin(currentSeed++)*1e4;return x-Math.floor(x);};// Fisher-Yates shuffle algorithm
for(let i=shuffled.length-1;i>0;i--){const j=Math.floor(random()*(i+1));[shuffled[i],shuffled[j]]=[shuffled[j],shuffled[i]];}return shuffled;}function getPropertyControl(fieldName,fieldType,referenceFieldName,referenceFieldType,propertyControlsByTitle,mainAlias,defaultReferencePropertyTitle=""){let property=propertyControlsByTitle[mainAlias]?.[fieldName]||null;let mismatchedFieldName="";let mismatchedFieldType="";if(property){if(property.type==="collectionreference"){const alias=property.id;const propertyControls=propertyControlsByTitle[alias];if(propertyControls){const name=fieldType==="reference"?referenceFieldName:defaultReferencePropertyTitle;const control=propertyControls[name];if(control){if(referenceFieldType&&referenceFieldType!==control.type){mismatchedFieldName=fieldName;mismatchedFieldType=control.type;}else{property={...control,id:`${alias}.${control.id}`};}}}}else if(property.type!==fieldType){mismatchedFieldName=fieldName;mismatchedFieldType=fieldType;}}return{property,mismatchedFieldName,mismatchedFieldType};}function processField(field,fieldValue,filterValue,multiSelect,conditionContains,multiReferenceItemsById){if(field.type==="multicollectionreference"&&Array.isArray(fieldValue)){// const rItems = multiReferenceItemsById[field.referenceAlias]
for(const item of fieldValue){if(!item){continue;}const itemValue=item[field.referenceId];if(itemValue===null||itemValue===undefined){continue;}if(filterData(itemValue,filterValue,field.referenceType,multiSelect,conditionContains)){return true;}}}else{if(fieldValue===null||fieldValue===undefined){return false;}return filterData(fieldValue,filterValue,field.type,multiSelect,conditionContains);}return false;}function filterData(fieldValue,filterValue,fieldType,multiSelect,conditionContains){if(typeof filterValue=="string"&&multiSelect){const values=filterValue.split(DELIMITER);switch(fieldType){case FieldType.String:case FieldType.Enum:if(conditionContains){for(const v of values){if(fieldValue.includes(v)){return true;}}}else{if(values.includes(fieldValue)){return true;}}break;}}else{switch(fieldType){case FieldType.Boolean:if(fieldValue==filterValue){return true;}break;case FieldType.String:case FieldType.Enum:if(conditionContains){if(fieldValue?.includes(filterValue)){return true;}}else{if(fieldValue==filterValue){return true;}}break;}}return false;}function modifySelect(query,filters,search,searchFields,sort,propertyControlsByTitle,collections){const filterIds=Object.keys(filters);const hasFilters=filterIds.length;if(query?.select&&(hasFilters||search||sort?.sortBy==="field")){const fields=[];if(hasFilters){for(const filterId of filterIds){const filter=filters[filterId];if(filter.fieldType===FilterFieldType.MultipleOptions){for(const name of filter.fieldName.split(DELIMITER)){fields.push({name:name});}}else if(filter.fieldType===FilterFieldType.Reference){fields.push({name:filter.fieldName,referenceFieldName:filter.referenceFieldName});}else{fields.push({name:filter.fieldName});}}}for(const field of searchFields){if(field.fieldType==="reference"){fields.push({name:field.fieldName,referenceFieldName:field.referenceFieldName});}else{fields.push({name:field.fieldName});}}if(sort&&sort.sortBy==="field"){fields.push({name:sort.fieldName});}// Deduplicate fields
const uniqueFields=[];for(const field of fields){if(!uniqueFields.some(f=>f.name===field.name&&f.referenceFieldName===field.referenceFieldName)){uniqueFields.push(field);}}return addFieldsToSelect(uniqueFields,query,propertyControlsByTitle,collections);}return query?.select;}function mapCollectionDataValues(items,propertyControlsById,mainAlias,multiReferenceItemsById,multiReferenceIdMap){if(!Array.isArray(items)||typeof propertyControlsById!=="object"||typeof multiReferenceItemsById!=="object"||typeof multiReferenceIdMap!=="object"||typeof mainAlias!=="string"){return items// Return the original array if inputs are invalid
;}const mainPropertyControlsById=propertyControlsById[mainAlias];// Create a shallow copy of the items array
const copiedItems=items.map(item=>({...item}));for(const propertyId of Object.keys(mainPropertyControlsById)){const property=mainPropertyControlsById[propertyId];if(property.type==="enum"){const optionMap={};if(property.options&&property.optionTitles){for(let i=0;i<property.options.length;i++){optionMap[property.options[i]]=property.optionTitles[i];}}for(const item of copiedItems){if(item[propertyId]){item[propertyId]=optionMap[item[propertyId]]||"";}}}else if(property.type==="multicollectionreference"){const alias=multiReferenceIdMap[propertyId];const referenceItemsById=multiReferenceItemsById[alias];if(referenceItemsById){for(const item of copiedItems){const referenceItems=item[alias];const rPropertyControlsById=propertyControlsById[alias];const newItemValues=[];if(Array.isArray(referenceItems)&&typeof rPropertyControlsById==="object"){const rCopiedItems=referenceItems.map(item=>{const value=typeof item==="string"?referenceItemsById[item]:item;return value?{...value}:{};});for(const propertyId of Object.keys(rPropertyControlsById)){const property=rPropertyControlsById[propertyId];if(property.type==="enum"){const optionMap={};if(property.options&&property.optionTitles){for(let i=0;i<property.options.length;i++){optionMap[property.options[i]]=property.optionTitles[i];}}for(const item of rCopiedItems){if(item[propertyId]){item[propertyId]=optionMap[item[propertyId]]||"";}}}}for(const item of rCopiedItems){newItemValues.push(item);}}item[propertyId]=newItemValues;}}}}return copiedItems;}function getSearchLevelForValue(value,searchText){if(value==undefined||value==null){return 0;}const text=String(value).toLowerCase();if(text==searchText){return 4;}else if(text.includes(searchText)){if(text.startsWith(searchText)){return 3;}else if((" "+text+" ").includes(" "+searchText+" ")){return 2;}else{return 1;}}return 0;}const Transition=({value,children})=>{const config=useContext(MotionConfigContext);const transition=value??config.transition;const contextValue=useMemo(()=>({...config,transition}),[JSON.stringify(transition)]);return /*#__PURE__*/_jsx(MotionConfigContext.Provider,{value:contextValue,children:children});};
export const __FramerMetadata__ = {"exports":{"LayoutType":{"type":"tsType","annotations":{"framerContractVersion":"1"}},"SearchFieldType":{"type":"tsType","annotations":{"framerContractVersion":"1"}},"default":{"type":"reactComponent","name":"Superfields","slots":[],"annotations":{"framerSupportedLayoutHeight":"any","framerSupportedLayoutWidth":"any-prefer-fixed","framerIntrinsicWidth":"600","framerDisableUnlink":"","framerContractVersion":"1"}},"__FramerMetadata__":{"type":"variable"}}}