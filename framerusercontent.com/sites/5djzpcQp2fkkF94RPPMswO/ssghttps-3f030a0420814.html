import{jsx as _jsx}from"react/jsx-runtime";import{addPropertyControls,// @ts-ignore getPropertyControls,ControlType,useIsOnFramerCanvas}from"framer";import{useEffect,useState,useRef}from"react";import{useStore}from"https://framerusercontent.com/modules/oaAH7umUjUOTeKmykfom/4GSr51yWhuxjuWu6QpOf/Stores.js";import{useDebouncer,useConsoleLogWhenDebuggingCMSPlus}from"https://framerusercontent.com/modules/uaC9hWf3ec7HqMv3sXMc/fThGQnEUZeWwDLSQMzea/Hooks.js";import
CollectionIDControl from"https://framerusercontent.com/modules/Hxho9sUnioBkMjGbLBed/csoxszrftuhmv2NyuE1c/collectionID.js";/** * @framerSupportedLayoutWidth any * @framerSupportedLayoutHeight any * * @framerDisableUnlink */export default function Search_Plus(props){const{fontColor,cmsFieldNames,fontStyles,placeHolderColor,placeHolderText,preserveFilter,selectedRealTimeSearches,onInput}=props;const
fieldPlusComponent="Search+";const[store,setStore]=useStore();/** * looks for at least one valid collection ID in store. * * if Search+ has multiple elements in selectedRealTimeSearches listed, then i all listed valid collections will have the same realTimeSearch.text
string */const foundValidCollection=selectedRealTimeSearches.find(({collectionID})=>!!store[collectionID]);const collection=store[foundValidCollection?.collectionID]||null;const collectionIsInitialized=!!collection;// gather all the real time search text
form every initialized collection in the store // it will be used watch the value that will trigger a useEffect when any value is cleared remotely const realTimeSearchTexts=Object.values(store).map(collection=>collection.realTimeSearch.text);const supportedFieldTypes=["string"];const
isOnFramerCanvas=useIsOnFramerCanvas();const{consoleLogWhenDebuggingCMSPlus}=useConsoleLogWhenDebuggingCMSPlus();const[userInput,setUserInput]=useState(collectionIsInitialized?collection.realTimeSearch.text:"");const userInputDebounced=useDebouncer({delay:200,value:userInput});const[inputHasFocus,setInputHasFocus]=useState(false);const
hasMountedRef=useRef(false);const inputStyles={...props.style,...fontStyles,backgroundColor:"transparent",border:"none",color:!inputHasFocus&&!userInput?placeHolderColor:fontColor,outline:"none",width:"100%"};const handleOnInput=e=>{// allows for an override
to hook into the change event if(onInput&&typeof onInput==="function")onInput?.(e);if(collectionIsInitialized)setUserInput(e.target.value);};const handleInputOnFocus=()=>setInputHasFocus(true);const handleInputOnBlur=()=>setInputHasFocus(false);// handles
realTimeSearch.text and input change. reset the input value if the realTimeSearch.text is cleared externally from Clear+ useEffect(()=>{if(collectionIsInitialized&&hasMountedRef.current&&!!userInputDebounced&&!collection.realTimeSearch.text){consoleLogWhenDebuggingCMSPlus("ðŸ†‘:","Search+:",`
id#s [${selectedRealTimeSearches.map(search=>search.collectionID).join(",")}] cleared remotely.`);setUserInput("");}},[collectionIsInitialized,...realTimeSearchTexts]);// handles userInputDebounced // when userInputDebounced is different from userInput,
it will update the realTimeSearch.text in collection's store useEffect(()=>{if(collectionIsInitialized&&userInputDebounced!==collection.realTimeSearch?.text){consoleLogWhenDebuggingCMSPlus("ðŸ”:","Search+:",`"${userInputDebounced}"`);setStore(prev=>{const
newStore={...prev};// loop through each element in selectedRealTimeSearches // each element will contain a collectionID for(let index=0;index
<selectedRealTimeSearches.length;index++){const{clearAllActiveFilters,cmsFieldNames,collectionID}=selectedRealTimeSearches[index];//
    get the collection from store const collection=newStore[collectionID];// skip if collection not initiated in store if(!collection)continue;// set the input text newStore[collectionID].realTimeSearch.text=userInputDebounced;// the input text will be searched
    in these fields const searchFields=[];// loop through each field in this collection for(const[fieldName,{type}]of Object.entries(collection.fields)){// skip if this field does not have any filters or the type is not supported if(!supportedFieldTypes.includes(type))continue;//
    push field if clearAllActiveFilters was selected, otherwise push if included in cmsFieldNames array if(clearAllActiveFilters||cmsFieldNames.includes(fieldName)){searchFields.push(fieldName);}}// set the searchFields to collection store realTimeSearch
    newStore[collectionID].realTimeSearch.fields=searchFields;}return{...newStore};});}},[collectionIsInitialized,userInputDebounced]);// clean up function to reset when user is not preserving this filter search useEffect(()=>{hasMountedRef.current=true;return()=>{if(collectionIsInitialized&&!preserveFilter){setStore(prev=>{const newStore={...prev};for(let index=0;index
    <selectedRealTimeSearches.length;index++){const{collectionID}=selectedRealTimeSearches[index];const collection=newStore[collectionID];if(!collection)continue;newStore[collectionID].realTimeSearch={...newStore[collectionID].realTimeSearch,text:
        "",fields:[]};}return{...newStore};});}};},[collectionIsInitialized,preserveFilter]);return /*#__PURE__*/_jsx( "input",{style:inputStyles,type: "text",value:!inputHasFocus&&!userInput?placeHolderText:userInput,onChange:handleOnInput,onFocus:handleInputOnFocus,onBlur:handleInputOnBlur});}Search_Plus.displayName="Search+"
        ;addPropertyControls(Search_Plus,{selectedRealTimeSearches:{type:ControlType.Array,title: "Searches",defaultValue:[],description:`Explore its [documentation](https://framercms.plus/documentation/component-search-plus).`,control:{type:ControlType.Object,title:
        "Collections & Fields",controls:{...getPropertyControls(CollectionIDControl),clearAllActiveFilters:{type:ControlType.Boolean,title: "All Fields",defaultValue:true,description: "Slug field is included."},cmsFieldNames:{type:ControlType.Array,title: "Fields",defaultValue:[],description:
        "Must match exactly as the field is named in its collection.",control:{type:ControlType.String,title: "Field",defaultValue: ""},hidden:props=>props.clearAllActiveFilters}}}},preserveFilter:{type:ControlType.Boolean,title:"Preserve",defaultValue:true,description:`Input text. [Explore feature.](https://framercms.plus/documentation/preserve-settings)`},fontStyles:{type:ControlType.Font,controls:"extended",title:"Font"},fontColor:{type:ControlType.Color,title:"Font
        Color"},placeHolderText:{type:ControlType.String,title:"Placeholder",defaultValue:"CMS Plus Search+ Component",placeholder:"Optional"},placeHolderColor:{type:ControlType.Color,title:"Placeholder Color",defaultValue:"#b8b8b8"}}); export const __FramerMetadata__
        = {"exports":{"default":{"type":"reactComponent","name":"Search_Plus","slots":[],"annotations":{"framerContractVersion":"1","framerSupportedLayoutWidth":"any","framerSupportedLayoutHeight":"any","framerDisableUnlink":""}},"__FramerMetadata__":{"type":"variable"}}}
        //# sourceMappingURL=./Search_Plus.map